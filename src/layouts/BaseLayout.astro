---
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { ViewTransitions } from "astro:transitions";
import "../style/global.css";

const {
	pageTitle = "Audiofool",
	headTitle = pageTitle,
	description = "Projects, notes, photography, and music logs from Audiofool — where research meets creativity.",
	lede,
	hideHeading = false,
	enableGlow = false,
} = Astro.props;

const documentTitle = headTitle ? `${headTitle} · Audiofool` : "Audiofool";
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="generator" content={Astro.generator} />
		<link rel="icon" type="image/png" href="/audiofool.png" />

		<!-- SEO -->
		<title>{documentTitle}</title>
		<meta name="description" content={description} />
		<meta property="og:title" content={documentTitle} />
		<meta property="og:description" content={description} />
		<meta property="og:type" content="website" />
		<meta name="twitter:card" content="summary" />
		<meta name="twitter:title" content={documentTitle} />
		<meta name="twitter:description" content={description} />

		<!-- Theme -->
		<meta
			name="theme-color"
			content="#0a0a0a"
			media="(prefers-color-scheme: dark)"
		/>
		<meta
			name="theme-color"
			content="#fafafa"
			media="(prefers-color-scheme: light)"
		/>

		<!-- KaTeX for LaTeX rendering -->
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
			integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV"
			crossorigin="anonymous"
		/>

		<script is:inline>
			(function () {
				const storageKey = "theme";
				const prefersDark = window.matchMedia(
					"(prefers-color-scheme: dark)",
				);
				const storedTheme = localStorage.getItem(storageKey);
				const initialTheme =
					storedTheme ?? (prefersDark.matches ? "dark" : "light");

				if (initialTheme === "dark") {
					document.documentElement.classList.add("dark");
				}
			})();
		</script>

		{/* Astro View Transitions */}
	</head><import {ViewTransitions} from 'astro:transitions';></import>
	<ViewTransitions />

	<body>
		<div class:list={["site-shell", { "glow-bg": enableGlow }]}>
			<Header />
			<main class="flex-1">
				{
					!hideHeading && (
						<header class="mb-10 md:mb-14 animate-fade-in">
							<h1 class="text-4xl md:text-5xl font-heading font-bold mb-4 tracking-tight">
								{pageTitle}
							</h1>
							{lede && (
								<p
									class="text-lg"
									style="color: var(--text-muted);"
								>
									{lede}
								</p>
							)}
						</header>
					)
				}
				<slot />
			</main>
			<Footer />
		</div>
	</body>

</html>
