---
import BaseLayout from "../layouts/BaseLayout.astro";
import BlogPost from "../components/BlogPost.astro";

const allPosts = await Astro.glob("./posts/projects/*.md");
const headTitle = "Projects";
const pageTitle = "Projects";
const lede = "Where my experiments live: shipping audio tools, writing long-form guides, and prototyping learning systems.";

const statusGroups = [
	{ emoji: "ðŸ“–", label: "In progress", key: "in progress" },
	{ emoji: "ðŸ“•", label: "First phase complete", key: "(first phase) completed" },
	{ emoji: "ðŸŒ±", label: "Ideas on deck", key: "idea" },
];
const formatDate = (value) =>
	new Date(value).toLocaleDateString("en", {
		month: "short",
		year: "numeric",
	});
---

<BaseLayout pageTitle={pageTitle} headTitle={headTitle} lede={lede}>
	<section>
		<p class="eyebrow">Overview</p>
		<p class="muted">
			Projects here range from heavy research write-ups to fun micro-sites. Status labels are honest snapshots, not marketing speak.
		</p>
	</section>

	{statusGroups.map((group) => {
		const entries = allPosts
			.filter((post) => post.frontmatter.status === group.key)
			.sort((a, b) => new Date(b.frontmatter.pubDate).getTime() - new Date(a.frontmatter.pubDate).getTime());
		return (
			<section>
				<div class="section-header">
					<p class="eyebrow">{group.emoji} {group.label}</p>
				</div>
				{entries.length === 0 ? (
					<p class="muted">No entries yet â€” check back soon.</p>
				) : (
					<ul class="list-reset grid-auto">
						{entries.map((post) => (
							<BlogPost
								url={post.url}
								title={post.frontmatter.title}
								description={post.frontmatter.description}
								meta={`${group.label} Â· ${formatDate(post.frontmatter.pubDate)}`}
								tags={post.frontmatter.tags}
							/>
						))}
					</ul>
				)}
			</section>
		);
	})}
</BaseLayout>
